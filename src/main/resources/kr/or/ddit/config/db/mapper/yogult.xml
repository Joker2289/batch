<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="yogult">

	  <select id="getCycleList" resultType="cycleVO">
	  		select * from cycle
	  </select>
	  
	  <insert id="insertDaily" parameterType="dailyVO">
	  		insert into daily
	  			values (#{cid}, #{pid}, #{dt}, #{cnt})
	  </insert>
	  
	  <!--
	  	 입력하려고하는 데이터가 존재하면 update, 없으면 insert 
	  	 입력하려는 데이터 존재여부 확인
	  -->
	  <insert id="mergeDaily" parameterType="dailyVO">
		merge into daily
			using dual on(
				daily.cid = 1 and
				daily.pid = 100 and
				daily.dt = '20190306')
		<!-- matched : 해당 데이터가 존재 -->
		when matched then update set
			cnt = #{cnt}
		when not matched then insert
			(cid, pid, dt, cnt) values (#{cid}, #{pid}, #{dt}, #{cnt})
	  </insert>
</mapper>